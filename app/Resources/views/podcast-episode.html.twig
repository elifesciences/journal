{% set criticalCss = 'podcast-episode' %}

{% extends '::page.html.twig' %}

{% block title %}{{ title|striptags }} | Podcast{% endblock %}

{% block meta %}

    {{ parent() }}

    {% for source in item.sources %}
        <meta property="og:audio:url" content="{{ source.uri }}">
        <meta property="og:audio:type" content="{{ source.mediaType }}">
    {% endfor %}

{% endblock %}

{% block body %}

    {{ render_pattern(contentHeader) }}

    {% include 'calls-to-action.html.twig' %}

    {% embed 'grid/listing-two-column.html.twig' %}

        {% block main %}

            <h3 class="list-heading">Chapters</h3>
            <ol class="listing-list">
                {% for chapter in chapters %}
                    <li class="listing-list__item">
                        {{ render_pattern(chapter) }}
                    </li>
                {% endfor %}
            </ol>

        {% endblock %}

        {% block secondary %}

            {% if related %}

                <div class="grid-secondary-column__item">

                    {{ render_pattern(related) }}

                </div>

            {% endif %}

        {% endblock %}

    {% endembed %}

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "PodcastEpisode",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "{{ url('podcast', {podcast: item.number}) }}"
            },
            "headline": {{ title|striptags|json_encode(constant('JSON_UNESCAPED_UNICODE'))|raw }},
            "image": [
                "{{ iiif_uri(item.thumbnail) }}"
            ],
            "datePublished": "{{ item.publishedDate|date('Y-m-d', 'UTC') }}",
            "publisher": {
                "@type": "Organization",
                "name": "eLife Sciences Publications, Ltd",
                "logo": {
                    "@type": "ImageObject",
                    "url": "{{ absolute_url(asset('assets/patterns/img/patterns/organisms/elife-logo-full-2x.png')) }}"
                }
            },
            {% if item.impactStatement|default(null) -%}
                "description": {{ item.impactStatement|striptags|json_encode(constant('JSON_UNESCAPED_UNICODE'))|raw }},
            {% endif %}
            "isPartOf": {
                "@type": "Periodical",
                "name": "eLife",
                "issn": "2050-084X"
            }
        }
    </script>

{% endblock %}
